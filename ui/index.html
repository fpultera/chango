<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Chango üêµ</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #313338; color: #dbdee1; margin: 0; display: flex; flex-direction: column; height: 100vh; }
        header { background: #2b2d31; padding: 15px; box-shadow: 0 1px 2px rgba(0,0,0,0.2); font-weight: bold; color: white; }
        #chat { flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 8px; }
        .message { background: #383a40; padding: 10px 15px; border-radius: 5px; max-width: 70%; line-height: 1.4; }
        .input-area { background: #2b2d31; padding: 20px; display: flex; gap: 10px; }
        input { flex: 1; padding: 12px; border-radius: 8px; border: none; background: #383a40; color: white; outline: none; }
        button { padding: 10px 25px; background: #5865f2; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; }
        button:hover { background: #4752c4; }
    </style>
</head>
<body>

<header># canal-general (Chango App)</header>

<div id="chat"></div>

<div class="input-area">
    <input type="text" id="msgInput" placeholder="Escribe un mensaje..." autocomplete="off">
    <button id="sendBtn">Enviar</button>
</div>

<script>
    // Preguntamos un nombre para identificar al usuario
    const userName = prompt("¬øCu√°l es tu nombre de chango?", "Invitado") || "An√≥nimo";
    const chat = document.getElementById("chat");
    const input = document.getElementById("msgInput");
    const btn = document.getElementById("sendBtn");

    const socket = new WebSocket("ws://" + window.location.host + "/ws");

    socket.onmessage = function(event) {
        const msgDiv = document.createElement("div");
        msgDiv.className = "message";
        msgDiv.innerHTML = `<b style="color: #fff">${event.data.split(': ')[0]}:</b> ${event.data.split(': ')[1] || event.data}`;
        chat.appendChild(msgDiv);
        chat.scrollTop = chat.scrollHeight;
    };

    function sendMessage() {
        if (input.value.trim() !== "") {
            // Enviamos el mensaje con el formato "Nombre: Mensaje"
            socket.send(`${userName}: ${input.value}`);
            input.value = "";
        }
    }

    btn.onclick = sendMessage;
    input.onkeypress = (e) => { if(e.key === 'Enter') sendMessage() };

    socket.onopen = () => console.log("Conectado al servidor de Chango");
    socket.onclose = () => alert("Conexi√≥n perdida con el servidor.");
</script>

</body>
</html>